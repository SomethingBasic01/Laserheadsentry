-- Upload a program to the server
local function uploadProgram(fileName, fileContent)
    rednet.open("right")
    rednet.broadcast(fileName .. "," .. fileContent, "upload")
    
    local event, senderID, protocol, response = os.pullEvent("modem_message")
    if protocol == "upload_response" then
        print(response)
    end
    
    rednet.close("right")
    print("Uploaded file:", fileName)
end

-- Download a program from the server
local function downloadProgram(fileName)
    rednet.open("right")
    rednet.broadcast(fileName, "download")
    
    local event, senderID, protocol, fileContent = os.pullEvent("modem_message")
    if protocol == "file_content" then
        if fileContent ~= "File not found" then
            local filePath = fs.combine("", fileName)
            local file = fs.open(filePath, "w")
            file.write(fileContent)
            file.close()
            
            print("Downloaded file:", fileName)
        else
            print("File not found on server")
        end
    end
    
    rednet.close("right")
end

-- User interface to choose between upload and download
local function main()
    print("Do you want to (1) upload or (2) download a file?")
    local choice = read()
    
    if choice == "1" then
        print("Enter the file name to upload:")
        local fileName = read()
        print("Enter the file content:")
        local fileContent = read()
        
        uploadProgram(fileName, fileContent)
    elseif choice == "2" then
        print("Enter the file name to download:")
        local fileName = read()
        
        downloadProgram(fileName)
    else
        print("Invalid choice")
    end
end

main()
